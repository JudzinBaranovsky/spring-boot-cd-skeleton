plugins {
    id 'io.spring.dependency-management' version '1.1.3' apply false
    id 'info.solidsoft.pitest' version '1.9.11' apply false
}

def checkstyleConfigs = layout.projectDirectory.dir("config/checkstyle")
def checkstyleRules = checkstyleConfigs.file("checkstyle.xml").asFile
def checkstyleReport = resources.text.fromFile(checkstyleConfigs.file("checkstyle-report.xsl"))

subprojects {

    group = 'org.bananalaba.springcdtemplate'
    version = '1.0.0'

    apply plugin: 'io.spring.dependency-management'
    apply plugin: 'java'
    apply plugin: 'checkstyle'

    sourceCompatibility = '1.20'

    repositories {
        mavenLocal()
        mavenCentral()
    }

    test {
        useJUnitPlatform()
    }

    dependencyManagement {
        dependencies {
            dependency "org.apache.commons:commons-lang3:$rev_commons_lang"
            dependency "com.google.guava:guava:$rev_guava"

            dependency "com.fasterxml.jackson.core:jackson-databind:$rev_jackson"

            dependency "org.projectlombok:lombok:$rev_lombok"
            dependency "org.projectlombok:lombok:$rev_lombok"

            dependency "org.projectlombok:lombok:$rev_lombok"
            dependency "org.projectlombok:lombok:$rev_lombok"

            dependency "org.junit.jupiter:junit-jupiter:$rev_junit"
            dependency "org.mockito:mockito-core:$rev_mockito"
            dependency "org.mockito:mockito-junit-jupiter:$rev_mockito"
            dependency "org.assertj:assertj-core:$rev_assertj"
        }
    }

    dependencies {
        compileOnly "org.projectlombok:lombok"
        annotationProcessor "org.projectlombok:lombok"

        testCompileOnly "org.projectlombok:lombok"
        testAnnotationProcessor "org.projectlombok:lombok"

        testImplementation "org.junit.jupiter:junit-jupiter"
        testImplementation "org.mockito:mockito-core"
        testImplementation "org.mockito:mockito-junit-jupiter"
        testImplementation "org.assertj:assertj-core"
    }

    tasks.withType(Checkstyle) {
        configFile = checkstyleRules
        reports {
            html.stylesheet = checkstyleReport
        }
    }

}
